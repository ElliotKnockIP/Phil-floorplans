<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Site Maps</title>
    <link rel="icon" type="image/x-icon" href="./images/icons/ipfavicon.jpg" />
    <link href="https://unpkg.com/cropperjs@1.5.13/dist/cropper.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- Main Sidebar -->
    <div id="sidebar">
      <button class="sidebar-btn" data-menu="project-options-submenu">
        <img src="./images/icons/project-options.svg" alt="Project Options Icon" />
        <span>Project Options</span>
      </button>
      <button class="sidebar-btn" data-menu="add-devices-submenu">
        <img src="./images/icons/add-devices.svg" alt="Add Devices Icon" />
        <span>Add Devices</span>
      </button>
      <button class="sidebar-btn" data-menu="drawing-tools-submenu">
        <img src="./images/icons/drawing-tools.svg" alt="Drawing Tools Icon" />
        <span>Drawing Tools</span>
      </button>
      <button class="sidebar-btn" data-menu="client-details-submenu">
        <img src="./images/icons/client-details.svg" alt="Client Icon" />
        <span>Client Details</span>
      </button>
      <button class="sidebar-btn" data-menu="adjust-layers-submenu">
        <img src="./images/icons/print-images.svg" alt="Print Images Icon" />
        <span>Print Report</span>
      </button>
    </div>

    <!-- Sub Sidebar -->
    <div id="sub-sidebar" class="sub-sidebar hidden">
      <button id="close-sub-sidebar"><img src="./images/icons/close.svg" alt="Close Subbar Icon" /></button>

      <!-- Project Options Submenu -->
      <div id="project-options-submenu" class="submenu">
        <h3>Project Options</h3>
        <button id="select-background-btn" class="submenu-button">
          <div class="icon-label">
            <img src="./images/icons/upload-background.svg" alt="Select Background Icon" />
            <span>Select Background</span>
          </div>
        </button>
        <button id="clear-canvas-btn" class="submenu-button">
          <div class="icon-label">
            <img src="./images/icons/clear-canvas.svg" alt="Clear Canvas Icon" />
            <span>Clear Canvas</span>
          </div>
        </button>
        <hr />
        <button id="download-background-btn" class="submenu-button">
          <div class="icon-label">
            <img src="./images/icons/download.svg" alt="Download Icon" />
            <span>Download PNG</span>
          </div>
        </button>
        <button class="submenu-button" id="save-project-btn">
          <div class="icon-label">
            <img src="./images/icons/save.svg" alt="Save Icon" />
            <span>Save Project</span>
          </div>
        </button>
        <button class="submenu-button" id="load-project-btn">
          <div class="icon-label">
            <img src="./images/icons/open.svg" alt="Open Icon" />
            <span>Load Project</span>
          </div>
          <input type="file" id="load-project-input" accept=".json" style="display: none" />
        </button>
        <h4 style="text-align: center; padding-bottom: 8px">Adjust Layers</h4>
        <span><input type="checkbox" id="background-layer-toggle" class="show-toggle" checked />Background Layer</span>
        <input type="range" id="background-layer-opacity-slider" class="layer-sidebar-slider" min="0" max="100" step="1" value="100" />
        <span><input type="checkbox" id="zones-layer-toggle" class="show-toggle" checked />Zones Layer</span>
        <input type="range" id="zones-layer-opacity-slider" class="layer-sidebar-slider" min="0" max="100" step="1" value="100" />
        <span><input type="checkbox" id="devices-layer-toggle" class="show-toggle" checked />Devices Layer</span>
        <input type="range" id="devices-layer-opacity-slider" class="layer-sidebar-slider" min="0" max="100" step="1" value="100" />
        <span><input type="checkbox" id="drawings-layer-toggle" class="show-toggle" checked />Drawings Layer</span>
        <input type="range" id="drawings-layer-opacity-slider" class="layer-sidebar-slider" min="0" max="100" step="1" value="100" style="margin-bottom: 10px" />
        <h4 style="text-align: center; padding-bottom: 8px">System Layers</h4>
        <span><input type="checkbox" id="cctv-layer-toggle" class="show-toggle" checked />CCTV Layer</span>
        <input type="range" id="cctv-layer-opacity-slider" class="layer-sidebar-slider" min="0" max="100" step="1" value="100" />
        <span><input type="checkbox" id="intruder-layer-toggle" class="show-toggle" checked />Intruder Layer</span>
        <input type="range" id="intruder-layer-opacity-slider" class="layer-sidebar-slider" min="0" max="100" step="1" value="100" />
        <span><input type="checkbox" id="fire-layer-toggle" class="show-toggle" checked />Fire Layer</span>
        <input type="range" id="fire-layer-opacity-slider" class="layer-sidebar-slider" min="0" max="100" step="1" value="100" />
        <span><input type="checkbox" id="access-layer-toggle" class="show-toggle" checked />Access Layer</span>
        <input type="range" id="access-layer-opacity-slider" class="layer-sidebar-slider" min="0" max="100" step="1" value="100" />
      </div>

      <!-- Devices Submenu -->
      <div id="add-devices-submenu" class="submenu">
        <h3>Add Devices</h3>
        <div id="cctv-devices">
          <button class="toggle-device-dropdown">
            <div class="icon-label">
              <img src="./images/devices/cctv-coloured.png" alt="Device Camera" />
              <span>CCTV System</span>
            </div>
            <img src="images/icons/expand-arrow.svg" alt="Expand Arrow" class="dropdown-icon" />
          </button>
          <div class="device-row">
            <div class="icon-container">
              <img src="./images/devices/fixed-camera.png" alt="Fixed Camera" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/ptz-camera.png" alt="PTZ Camera" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/box-camera.png" alt="Box Camera" />
            </div>
          </div>
          <div class="device-row">
            <div class="icon-container">
              <img src="./images/devices/dome-camera.png" alt="Dome Camera" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/bullet-camera.png" alt="Bullet Camera" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/thermal-camera.png" alt="Thermal Camera" />
            </div>
          </div>
        </div>
        <div id="access-control-devices">
          <button class="toggle-device-dropdown">
            <div class="icon-label">
              <img src="./images/devices/access-system-coloured.png" alt="Access Control Icon" />
              <span>Access Control</span>
            </div>
            <img src="images/icons/expand-arrow.svg" alt="Expand Arrow" class="dropdown-icon" />
          </button>
          <div class="device-row">
            <div class="icon-container">
              <img src="./images/devices/access-system.png" alt="Access Device" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/door-entry.png" alt="Door Entry Icon" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/gates.png" alt="Gates Icon" />
            </div>
          </div>
          <div class="device-row">
            <div class="icon-container">
              <img src="./images/devices/vehicle-entry.png" alt="Vehicle Entry Device" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/turnstiles.png" alt="Turnstiles Icon" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/mobile-entry.png" alt="Mobile Entry Icon" />
            </div>
          </div>
        </div>
        <div id="intruder-detection-devices">
          <button class="toggle-device-dropdown">
            <div class="icon-label">
              <img src="./images/devices/intruder-alarm-coloured.png" alt="Intruder Alarm Icon" />
              <span>Intruder Detection</span>
            </div>
            <img src="images/icons/expand-arrow.svg" alt="Expand Arrow" class="dropdown-icon" />
          </button>
          <div class="device-row">
            <div class="icon-container">
              <img src="./images/devices/intruder-alarm.png" alt="Intruder Device" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/panic-alarm.png" alt="Panic Alarm Icon" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/motion-detector.png" alt="Motion Detector Icon" />
            </div>
          </div>
          <div class="device-row">
            <div class="icon-container">
              <img src="./images/devices/infrared-sensors.png" alt="Infrared Sensors Device" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/pressure-mat.png" alt="Pressure Mat Icon" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/glass-contact.png" alt="Glass Contact Icon" />
            </div>
          </div>
        </div>
        <div id="fire-evacuation-devices">
          <button class="toggle-device-dropdown">
            <div class="icon-label">
              <img src="./images/devices/fire-coloured.png" alt="Fire Icon" />
              <span>Fire Evacuation</span>
            </div>
            <img src="images/icons/expand-arrow.svg" alt="Expand Arrow" class="dropdown-icon" />
          </button>
          <div class="device-row">
            <div class="icon-container">
              <img src="./images/devices/fire-alarm.png" alt="Fire Alarm Device" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/fire-extinguisher.png" alt="Fire Extinguisher Device" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/fire-blanket.png" alt="Fire Blanket Device" />
            </div>
          </div>
          <div class="device-row">
            <div class="icon-container">
              <img src="./images/devices/emergency-exit.png" alt="Emergency Exit Device" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/assembly-point.png" alt="Assembly Point Device" />
            </div>
            <div class="icon-container">
              <img src="./images/devices/emergency-telephone.png" alt="Emergency Telephone Device" />
            </div>
          </div>
        </div>
      </div>

      <!-- Drawing Tools Submenu -->
      <div id="drawing-tools-submenu" class="submenu">
        <h3>Drawing Tools</h3>
        <button id="add-wall-btn" class="submenu-button">
          <div class="icon-label">
            <img src="./images/icons/wall-boundaries.svg" alt="Wall Boundaries Icon" />
            <span>Wall Boundaries</span>
          </div>
        </button>
        <button id="create-zone-btn" class="submenu-button">
          <div class="icon-label">
            <img src="./images/icons/zones.svg" alt="Zones Icon" />
            <span>Create Zones</span>
          </div>
        </button>
        <button id="measure-btn" class="submenu-button">
          <div class="icon-label">
            <img src="./images/icons/measurement.svg" alt="Measurement Icon" />
            <span>Measurement</span>
          </div>
        </button>
        <button id="apex-btn" class="submenu-button">
          <div class="icon-label">
            <img src="./images/icons/apex.svg" alt="Apex Icon" />
            <span>Measure Apex</span>
          </div>
        </button>
        <button id="upload-image-btn" class="submenu-button">
          <div class="icon-label">
            <img src="./images/icons/upload-image.svg" alt="Upload Image Icon" />
            <span>Upload Image</span>
          </div>
        </button>
        <hr />
        <h5 style="margin-top: 5px">Shapes and Text</h5>
        <button id="add-text-btn" class="submenu-button">
          <div class="icon-label">
            <img src="./images/icons/text.svg" alt="Text Icon" />
            <span>Add Text</span>
          </div>
        </button>
        <button id="add-description-btn" class="submenu-button">
          <div class="icon-label">
            <img src="./images/icons/description.svg" alt="Description Icon" />
            <span>Add Description</span>
          </div>
        </button>
        <button class="submenu-button" id="add-square-btn">
          <div class="icon-label">
            <img src="./images/icons/square.svg" alt="Square Icon" />
            <span>Add Square</span>
          </div>
        </button>
        <button class="submenu-button" id="add-circle-btn">
          <div class="icon-label">
            <img src="./images/icons/circle.svg" alt="Circle Icon" />
            <span>Add Circle</span>
          </div>
        </button>
        <button class="submenu-button" id="add-line-btn">
          <div class="icon-label">
            <img src="./images/icons/line.svg" alt="Line Icon" />
            <span>Add Line</span>
          </div>
        </button>
        <button class="submenu-button" id="add-arrow-btn">
          <div class="icon-label">
            <img src="./images/icons/arrow.svg" alt="Arrow Icon" />
            <span>Add Arrow</span>
          </div>
        </button>
        <button class="submenu-button" id="add-connection-btn">
          <div class="icon-label">
            <img src="./images/icons/connection.svg" alt="Connection Icon" />
            <span>Add Connection</span>
          </div>
        </button>
        <button class="submenu-button" id="titleblock-btn">
          <div class="icon-label">
            <img src="./images/icons/horizontal-titleblock.svg" alt="Title Block Icon" />
            <span>Title Block</span>
          </div>
        </button>
        <button class="submenu-button" id="add-buildingfront-btn">
          <div class="icon-label">
            <img src="./images/icons/buildingfront.svg" alt="Building Icon" />
            <span>Building Front</span>
          </div>
        </button>
        <h5 style="margin-top: 5px; margin-bottom: 10px">Change Colour</h5>
        <input type="color" id="shapes-text-color-picker" value="#FFFFFF" />
      </div>

      <!-- Client Details Submenu -->
      <div id="client-details-submenu" class="submenu">
        <h3 style="margin-bottom: 10px">Client Details</h3>
        <span>Report Date:</span>
        <input type="date" id="client-date-input" />
        <span>Client Name:</span>
        <textarea class="client-details-input" id="client-name-test-input" maxlength="153"></textarea>
        <span>Client Address:</span>
        <textarea class="client-details-input" id="address-input" maxlength="153"></textarea>
        <span>Report Title:</span>
        <textarea class="client-details-input" id="report-title-input" maxlength="153"></textarea>
        <span>Rev 1:</span>
        <textarea class="client-details-input" id="rev-one-input" maxlength="153"></textarea>
        <span>Rev 2:</span>
        <textarea class="client-details-input" id="rev-two-input" maxlength="153"></textarea>
        <span>Rev 3:</span>
        <textarea class="client-details-input" id="rev-three-input" maxlength="153"></textarea>
        <button class="submenu-button" id="client-logo-test-input">
          <div class="icon-label">
            <img src="./images/icons/client-logo.svg" alt="Client Logo Icon" />
            <span>Client Logo</span>
          </div>
        </button>

        <input type="file" id="client-logo-upload" accept="image/*" style="display: none" />
        <div id="client-logo-preview" class="logo-preview"><span style="color: #999">No logo selected</span></div>
      </div>

      <!-- Adjust Layers Submenu -->
      <div id="adjust-layers-submenu" class="submenu">
        <h3 style="margin-bottom: 10px">Screenshots</h3>
        <button id="print-btn" class="submenu-button">
          <div class="icon-label">
            <img src="./images/icons/print.svg" alt="Print Project Icon" />
            <span>Print Report</span>
          </div>
        </button>
        <button id="capture-screenshot-btn" class="submenu-button">
          <div class="icon-label">
            <img src="./images/icons/capture-screenshot.svg" alt="Capture Screenshot Icon" />
            <span>Capture Screenshot</span>
          </div>
        </button>
        <div id="screenshot-previews" style="margin-top: 10px">
          <template id="screenshot-preview-template">
            <div class="screenshot-preview-item">
              <img class="screenshot-image" src="" alt="Screenshot" />
              <div class="screenshot-controls">
                <label class="screenshot-checkbox-label">
                  <input type="checkbox" class="screenshot-checkbox" />
                  <span>Include in print</span>
                </label>
                <textarea class="screenshot-title" placeholder="Title or Description" maxlength="74"></textarea>
                <button class="screenshot-delete-btn">Delete</button>
              </div>
            </div>
          </template>
        </div>
      </div>
    </div>

    <!-- Clear Warning Popup -->
    <div id="clear-warning-popup">
      <div id="clear-warning-container">
        <span id="warning-text">WARNING: This will completely remove everything on the canvas.</span>
        <button id="close-clear-warning">
          <span>Close</span>
        </button>
        <button id="confirm-clear-warning">
          <span>Confirm</span>
        </button>
      </div>
    </div>

    <!-- Drawing Mode Popup -->
    <div id="drawing-mode-popup">
      <div class="drawing-mode-container">
        <label>Drawing Mode <button id="drawing-esc-btn">ESC</button> to exit <button id="drawing-enter-btn">ENTER</button> to finish.</label>
      </div>
    </div>

    <!-- Select Background Popup -->
    <div id="select-background-popup" class="fullscreen-modal">
      <div class="modal-container">
        <div class="modal-header">
          <div class="modal-header-content">
            <div class="modal-header-left">
              <button id="cancelBackgroundBtn" class="modal-header-btn">
                <div class="icon-label">
                  <img src="./images/icons/close.svg" alt="Cancel Icon" />
                  <span>Cancel</span>
                </div>
              </button>
            </div>
            <div class="modal-header-center" id="selectBackgroundStages">
              <div class="background-steps">
                <span class="step">1</span>
                <span>Source</span>
              </div>
              <div class="background-steps">
                <span class="step">2</span>
                <span>Crop</span>
              </div>
              <div class="background-steps">
                <span class="step">3</span>
                <span>Scale</span>
              </div>
            </div>
            <div class="modal-header-right nav-buttons">
              <button class="modal-header-btn disabled-btn">
                <div class="icon-label">
                  <img src="./images/icons/back-arrow.svg" alt="Back Icon" />
                  <span>Back</span>
                </div>
              </button>
              <button class="modal-header-btn disabled-btn">
                <div class="icon-label">
                  <span>Next</span>
                  <img src="./images/icons/next-arrow.svg" alt="Next Icon" />
                </div>
              </button>
            </div>
          </div>
        </div>
        <div class="modal-body">
          <h2 class="modal-title">Select Background Source</h2>
          <div class="select-body-content">
            <button id="upload-files-btn" class="modal-header-btn">
              <div class="icon-label">
                <img src="./images/icons/upload-files.svg" alt="Upload Files Icon" />
                <span>Upload Files: JPG, PNG</span>
                <input type="file" id="uploaded-file" accept="image/*" style="display: none" />
              </div>
            </button>
            <button id="google-maps-satellite-btn" class="modal-header-btn">
              <div class="icon-label">
                <img src="./images/icons/google-maps.svg" alt="Maps Icon" />
                <span>Google Maps Satellite</span>
              </div>
            </button>
            <button id="custom-background-btn" class="modal-header-btn">
              <div class="icon-label">
                <img src="./images/icons/custom-background.svg" alt="custom Background Icon" />
                <span>Custom Background</span>
              </div>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Map Popup -->
    <div id="map-popup" class="fullscreen-modal">
      <div class="modal-container">
        <div class="modal-header">
          <div class="modal-header-content">
            <div class="modal-header-left">
              <button id="closeMapBtn" class="modal-header-btn">
                <div class="icon-label">
                  <img src="./images/icons/close.svg" alt="Cancel Icon" />
                  <span>Cancel</span>
                </div>
              </button>
            </div>
            <div class="modal-header-center" id="selectBackgroundStages">
              <div class="background-steps">
                <span class="step">1</span>
                <span>Source</span>
              </div>
              <div class="background-steps">
                <span class="step">2</span>
                <span>Crop</span>
              </div>
              <div class="background-steps">
                <span class="step">3</span>
                <span>Scale</span>
              </div>
            </div>
            <div class="modal-header-right nav-buttons">
              <button id="mapBackBtn" class="modal-header-btn">
                <div class="icon-label">
                  <img src="./images/icons/back-arrow.svg" alt="Back Icon" />
                  <span>Back</span>
                </div>
              </button>
              <button id="mapNextBtn" class="modal-header-btn">
                <div class="icon-label">
                  <span>Next</span>
                  <img src="./images/icons/next-arrow.svg" alt="Next Icon" />
                </div>
              </button>
            </div>
          </div>
        </div>
        <div class="modal-body">
          <form id="addressForm">
            <input type="text" id="addressInput" placeholder="Enter address, building name or postcode..." />
          </form>
          <div class="select-wrapper">
            <div id="map"></div>
            <div id="map-center-cross">
              <div class="horizontal-line"></div>
              <div class="vertical-line"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Custom Background Popup -->
    <div id="custom-popup" class="fullscreen-modal">
      <div class="modal-container">
        <div class="modal-header">
          <div class="modal-header-content">
            <div class="modal-header-left">
              <button id="closecustomBtn" class="modal-header-btn">
                <div class="icon-label">
                  <img src="./images/icons/close.svg" alt="Cancel Icon" />
                  <span>Cancel</span>
                </div>
              </button>
            </div>
            <div class="modal-header-center" id="selectBackgroundStages">
              <div class="background-steps">
                <span class="step">1</span>
                <span>Source</span>
              </div>
              <div class="background-steps">
                <span class="step">2</span>
                <span>Crop</span>
              </div>
              <div class="background-steps">
                <span class="step">3</span>
                <span>Scale</span>
              </div>
            </div>
            <div class="modal-header-right nav-buttons">
              <button id="customBackBtn" class="modal-header-btn">
                <div class="icon-label">
                  <img src="./images/icons/back-arrow.svg" alt="Back Icon" />
                  <span>Back</span>
                </div>
              </button>
              <button id="customNextBtn" class="modal-header-btn">
                <div class="icon-label">
                  <span>Next</span>
                  <img src="./images/icons/next-arrow.svg" alt="Finish Icon" />
                </div>
              </button>
            </div>
          </div>
        </div>
        <div class="modal-body">
          <h2 class="modal-title">Set Custom Background</h2>
          <div id="customWrapper" class="select-wrapper">
            <div class="input-group">
              <label for="customWidth" class="custom-label">Width (pixels):</label>
              <input type="number" id="customWidth" min="500" max="1920" value="1920" placeholder="500-1920" />
            </div>

            <div class="input-group">
              <label for="customHeight" class="custom-label">Height (pixels):</label>
              <input type="number" id="customHeight" min="250" max="1920" value="1000" placeholder="250-1920" />
            </div>

            <div class="input-group">
              <label for="customColor" class="custom-label">Background Color:</label>
              <select id="customColor">
                <option value="#16C47F">Green</option>
                <option value="#0000FF">Blue</option>
                <option value="#FFF085">Yellow</option>
                <option value="#F564A9">Pink</option>
                <option value="#DA6C6C">Red</option>
                <option value="#292929">Black</option>
                <option value="#FFFFFF">White</option>
              </select>
            </div>
            <div id="customPreviewWrapper">
              <canvas id="customPreviewCanvas"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Crop Popup -->
    <div id="crop-popup" class="fullscreen-modal">
      <div class="modal-container">
        <div class="modal-header">
          <div class="modal-header-content">
            <div class="modal-header-left">
              <button id="closeCropBtn" class="modal-header-btn">
                <div class="icon-label">
                  <img src="./images/icons/close.svg" alt="Cancel Icon" />
                  <span>Cancel</span>
                </div>
              </button>
            </div>
            <div class="modal-header-center" id="selectBackgroundStages">
              <div class="background-steps">
                <span class="step">1</span>
                <span>Source</span>
              </div>
              <div class="background-steps">
                <span class="step">2</span>
                <span>Crop</span>
              </div>
              <div class="background-steps">
                <span class="step">3</span>
                <span>Scale</span>
              </div>
            </div>
            <div class="modal-header-right nav-buttons">
              <button id="cropBackBtn" class="modal-header-btn">
                <div class="icon-label">
                  <img src="./images/icons/back-arrow.svg" alt="Back Icon" />
                  <span>Back</span>
                </div>
              </button>
              <button id="cropNextBtn" class="modal-header-btn">
                <div class="icon-label">
                  <span>Next</span>
                  <img src="./images/icons/next-arrow.svg" alt="Next Icon" />
                </div>
              </button>
            </div>
          </div>
        </div>
        <div class="modal-body">
          <h2 class="modal-title">Crop Background Area</h2>
          <div class="select-wrapper">
            <img id="croppableImage" />
          </div>
        </div>
      </div>
    </div>

    <!-- Scale Popup -->
    <div id="scale-popup" class="fullscreen-modal">
      <div class="modal-container">
        <div class="modal-header">
          <div class="modal-header-content">
            <div class="modal-header-left">
              <button id="closeScaleBtn" class="modal-header-btn">
                <div class="icon-label">
                  <img src="./images/icons/close.svg" alt="Cancel Icon" />
                  <span>Cancel</span>
                </div>
              </button>
            </div>
            <div class="modal-header-center" id="selectBackgroundStages">
              <div class="background-steps">
                <span class="step">1</span>
                <span>Source</span>
              </div>
              <div class="background-steps">
                <span class="step">2</span>
                <span>Crop</span>
              </div>
              <div class="background-steps">
                <span class="step">3</span>
                <span>Scale</span>
              </div>
            </div>
            <div class="modal-header-right nav-buttons">
              <button id="scaleBackBtn" class="modal-header-btn">
                <div class="icon-label">
                  <img src="./images/icons/back-arrow.svg" alt="Back Icon" />
                  <span>Back</span>
                </div>
              </button>
              <button id="finishScaleBtn" class="modal-header-btn">
                <div class="icon-label">
                  <span>Finish</span>
                  <img src="./images/icons/finish.svg" alt="Finish Icon" />
                </div>
              </button>
            </div>
          </div>
        </div>
        <div class="modal-body">
          <h2 class="modal-title">Set Scale and Distance</h2>
          <div id="scaleWrapper" class="select-wrapper">
            <img id="scaleableImage" />
          </div>
        </div>
      </div>
    </div>

    <!-- Right Sidebar Properties -->
    <div id="right-sidebar" class="right-sidebar hidden">
      <button id="close-right-sidebar"><img src="./images/icons/close.svg" alt="Close right sidebar Icon" /></button>
      <div id="right-sidebar-body">
        <div id="device-properties">
          <h2 id="device-heading">Device Properties</h2>
          <div id="camera-properties" class="sidebar-properties">
            <div>
              <label> <input type="checkbox" id="camera-coverage-toggle" class="show-toggle" checked />Show Camera Coverage</label>
            </div>
            <div>
              <span>Coverage Angle (°):</span>
              <input type="range" id="camera-angle-slider" class="sidebar-slider" min="1" max="360" step="1" value="90" />
              <input type="number" id="camera-angle-input" class="value-input" min="1" max="360" step="1" value="90" />
            </div>
            <div>
              <span>Coverage Distance (m):</span>
              <input type="range" id="camera-distance-slider" class="sidebar-slider" min="1" max="500" step="1" value="10" />
              <input type="number" id="camera-distance-input" class="value-input" min="1" max="500" step="1" value="10" />
            </div>
            <div>
              <span>Coverage Opacity:</span>
              <input type="range" id="camera-opacity-slider" class="sidebar-slider" min="0.01" max="1" step="0.01" value="0.25" />
              <input type="number" id="camera-opacity-input" class="value-input" min="0.01" max="1" step="0.01" value="0.25" />
            </div>

            <hr />
            <h4 style="text-align: center; padding: 8px 0px">Appearance</h4>
            <span>Coverage Colour:</span>
            <div class="change-coverage-colour sidebar-colour-background">
              <div class="colour-icon" data-color="#a59b9b" style="background-color: #a59b9b"></div>
              <div class="colour-icon" data-color="#000000" style="background-color: #000000"></div>
              <div class="colour-icon" data-color="#305CDE" style="background-color: #305cde"></div>
              <div class="colour-icon" data-color="#2E6F40" style="background-color: #2e6f40"></div>
              <div class="colour-icon" data-color="#6a0dad" style="background-color: #6a0dad"></div>
              <div class="colour-icon" data-color="#8b0000" style="background-color: #8b0000"></div>
              <input type="color" id="coverage-color-picker" class="sidebar-colour-picker" value="#808080" title="Pick a custom color" />
            </div>
            <div>
              <span>Camera Icon:</span>
              <div class="change-camera-icons">
                <img src="./images/devices/fixed-camera.png" alt="Fixed Camera Icon" />
                <img src="./images/devices/ptz-camera.png" alt="PTZ Camera Icon" />
                <img src="./images/devices/box-camera.png" alt="Box Camera Icon" />
                <img src="./images/devices/dome-camera.png" alt="Dome Camera Icon" />
              </div>
            </div>
          </div>

          <div id="generic-properties" class="sidebar-properties">
            <div id="device-name-toggle">
              <label> <input type="checkbox" id="device-label-toggle" class="show-toggle" checked />Show Device Name</label>
            </div>
            <div>
              <span>Device Name:</span>
              <input type="text" id="device-label-input" class="name-input" placeholder="Enter device name" />
            </div>
            <div class="fitting-position-options">
              <label for="fitting-positions" class="custom-label">Fitting Positions:</label>
              <select id="fitting-positions">
                <option>Select</option>
                <option value="top-left">Top Left</option>
                <option value="top-center">Top Center</option>
                <option value="top-right">Top Right</option>
                <option value="right-center">Right Center</option>
                <option value="bottom-right">Bottom Right</option>
                <option value="bottom-center">Bottom Center</option>
                <option value="bottom-left">Bottom Left</option>
                <option value="left-center">Left Center</option>
              </select>
            </div>
            <div>
              <span>Part Number:</span>
              <input type="text" id="device-part-number-input" class="name-input" placeholder="Enter Part Number" />
            </div>
            <div>
              <span>Stock Number:</span>
              <input type="text" id="device-stock-number-input" class="name-input" placeholder="Enter Stock Number" />
            </div>

            <div>
              <span>Device Colour:</span>
              <div class="change-icon-colour sidebar-colour-background">
                <div class="colour-icon" data-color="#fe8800" style="background-color: #fe8800"></div>
                <div class="colour-icon" data-color="#00ffff" style="background-color: #00ffff"></div>
                <div class="colour-icon" data-color="#fe0000" style="background-color: #fe0000"></div>
                <div class="colour-icon" data-color="#66ff00" style="background-color: #66ff00"></div>
                <div class="colour-icon" data-color="#ff00ff" style="background-color: #ff00ff"></div>
                <div class="colour-icon" data-color="#FFDE21" style="background-color: #ffde21"></div>
                <input type="color" id="icon-color-picker" class="sidebar-colour-picker" value="#fe8800" title="Pick a custom color" />
              </div>
            </div>
            <div id="custom-icon-upload">
              <span>Upload Custom Icon:</span>
              <input id="custom-icon-input" type="file" accept="image/jpeg,image/png" />
            </div>
            <div>
              <span>Icon Size (px):</span>
              <input type="range" id="icon-size-slider" class="sidebar-slider" min="1" max="100" step="1" value="50" />
              <input type="number" id="icon-size-input" class="value-input" min="1" max="100" step="1" value="50" />
            </div>
          </div>

          <div id="zone-properties" class="sidebar-properties">
            <div>
              <span><input type="checkbox" id="zone-name-toggle" class="show-toggle" checked />Show Zone Name</span>
            </div>
            <div>
              <span><input type="checkbox" id="zone-notes-toggle" class="show-toggle" checked />Show Zone Notes</span>
            </div>
            <div>
              <span><input type="checkbox" id="zone-area-toggle" class="show-toggle" checked />Show Zone Area</span>
            </div>
            <div>
              <span><input type="checkbox" id="zone-volume-toggle" class="show-toggle" checked />Show Zone Volume</span>
            </div>

            <div>
              <span>Zone Name:</span>
              <input type="text" id="zone-label-input" class="name-input" placeholder="Enter zone name" />
            </div>
            <div>
              <span>Zone Notes:</span>
              <input type="text" id="zone-notes-input" class="name-input" placeholder="Enter zone notes" />
            </div>
            <div>
              <span>Zone Height (m):</span>
              <input type="range" id="zone-height-slider" class="sidebar-slider" min="1" max="10" step="0.1" value="3" />
              <input type="number" id="zone-height-input" class="value-input" min="1" max="10" step="0.1" value="3" />
              <span id="zone-warning"></span>
            </div>
            <div>
              <span>Zone Text Size (px):</span>
              <input type="range" id="zone-text-size-slider" class="sidebar-slider" min="1" max="100" step="1" value="50" />
              <input type="number" id="zone-text-size-input" class="value-input" min="1" max="100" step="1" value="15" />
            </div>
            <div>
              <span>Zone Colour:</span>
              <div class="change-zone-colour sidebar-colour-background">
                <div class="colour-icon" data-color="#E05252" style="background-color: #e05252"></div>
                <div class="colour-icon" data-color="#52E052" style="background-color: #52e052"></div>
                <div class="colour-icon" data-color="#5252E0" style="background-color: #5252e0"></div>
                <div class="colour-icon" data-color="#E0E052" style="background-color: #e0e052"></div>
                <div class="colour-icon" data-color="#52E0E0" style="background-color: #52e0e0"></div>
                <div class="colour-icon" data-color="#E052E0" style="background-color: #e052e0"></div>
                <input type="color" id="zone-color-picker" class="sidebar-colour-picker" value="#E05252" title="Pick a custom color" />
              </div>
            </div>
            <div>
              <span>Zone Text Colour:</span>
              <div class="zone-text-colour sidebar-colour-background">
                <div class="colour-icon" data-color="#000000" style="background-color: #000000"></div>
                <div class="colour-icon" data-color="#4A4A4A" style="background-color: #4a4a4a"></div>
                <div class="colour-icon" data-color="#B22222" style="background-color: #b22222"></div>
                <div class="colour-icon" data-color="#228B22" style="background-color: #228b22"></div>
                <div class="colour-icon" data-color="#1E3A8A" style="background-color: #1e3a8a"></div>
                <div class="colour-icon" data-color="#5B2C6F" style="background-color: #5b2c6f"></div>
                <input type="color" id="zone-text-color-picker" class="sidebar-colour-picker" value="#E05252" title="Pick a custom color" />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="print-container">
      <div class="print-header">
        <div class="client-info-section">
          <p><strong>Client:</strong> <span id="print-client-name"></span></p>
          <p><strong>Address:</strong> <span id="print-address"></span></p>
          <p><strong>Date:</strong> <span id="print-date"></span></p>
        </div>
        <div class="logo-section">
          <img id="print-logo" />
        </div>
      </div>
      <div class="report-info-section">
        <h1 id="print-report-title"></h1>
      </div>
      <div class="canvas-section"></div>
    </div>

    <!-- Crop Modal -->
    <div id="crop-modal" class="crop-modal">
      <div class="crop-container">
        <div class="crop-header">
          <h3 id="crop-modal-title">Crop Canvas</h3>
          <p id="crop-modal-description">Select the area you want to include</p>
        </div>

        <div class="crop-image-container">
          <img id="crop-preview-image" class="crop-preview-image" src="" alt="Canvas preview" />
        </div>

        <div class="crop-controls">
          <button id="crop-cancel-btn" class="crop-btn">Cancel</button>
          <button id="crop-reset-btn" class="crop-btn">Reset Crop</button>
          <button id="crop-confirm-btn" class="crop-btn">Confirm</button>
        </div>
      </div>
    </div>

    <main>
      <div class="canvas-container">
        <canvas id="canvas-layout"></canvas>
        <input type="file" id="uploaded-background" accept="image/*" style="display: none" />
      </div>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
    <!-- Google Maps JS API -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA07kRUWXpno9PBLSDZ97ypqCTL93xRF_U&loading=async&libraries=places"></script>
    <script src="https://unpkg.com/cropperjs@1.5.13/dist/cropper.min.js"></script>
    <script type="module" src="scripts/canvas/canvas-init.js"></script>
    <script type="module" src="scripts/sidebar/device-sidebar.js"></script>
    <script type="module" src="scripts/sidebar/camera-sidebar.js"></script>
    <script type="module" src="scripts/sidebar/zones-sidebar.js"></script>
  </body>
</html>
